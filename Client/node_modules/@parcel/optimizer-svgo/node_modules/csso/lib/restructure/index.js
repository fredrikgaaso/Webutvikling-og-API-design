var prepare = require('csso/lib/restructure/prepare');
var mergeAtrule = require('csso/lib/restructure/1-mergeAtrule');
var initialMergeRuleset = require('csso/lib/restructure/2-initialMergeRuleset');
var disjoinRuleset = require('csso/lib/restructure/3-disjoinRuleset');
var restructShorthand = require('csso/lib/restructure/4-restructShorthand');
var restructBlock = require('csso/lib/restructure/6-restructBlock');
var mergeRuleset = require('csso/lib/restructure/7-mergeRuleset');
var restructRuleset = require('csso/lib/restructure/8-restructRuleset');

module.exports = function(ast, options) {
    // prepare ast for restructing
    var indexer = prepare(ast, options);
    options.logger('prepare', ast);

    mergeAtrule(ast, options);
    options.logger('mergeAtrule', ast);

    initialMergeRuleset(ast);
    options.logger('initialMergeRuleset', ast);

    disjoinRuleset(ast);
    options.logger('disjoinRuleset', ast);

    restructShorthand(ast, indexer);
    options.logger('restructShorthand', ast);

    restructBlock(ast);
    options.logger('restructBlock', ast);

    mergeRuleset(ast);
    options.logger('mergeRuleset', ast);

    restructRuleset(ast);
    options.logger('restructRuleset', ast);
};
